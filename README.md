A PySpark application to recommend users the music artists' they might like to listen to. The bigdata management and development infrastructure was provided by Databricks (Community Edition). 

The dataset (R1 - Yahoo! Music User Ratings of Musical Artists, version 1.0 (423 MB) was requested from Yahoo! Research, Webscope datasets(https://webscope.sandbox.yahoo.com/catalog.php?datatype=r). 

Dataset: The tab delimited dataset was obtained on request, from Yahoo for academic research, and it contained ratings of artists given by anonymized users’ over a 30-year period prior to March,2004. The data needed to build the recommendation system was provided in 2 text files. One of the files was 2GB in size, and had anonymized user ids, artist ids and their scores ranging from 0 to 100. A rating of 255 is given when a user rates an artist as “never play again”. The other file contains the artist’s id and their corresponding names.

Data Pre-processing: A parse function was defined to split the tab separated dataset and transform them to the format needed for development. All the records with ratings as 255, since the ALS algorithm might consider them to be very positive rating. The ratings were also scaled down to a range of 0-5, by dividing the original values by 20. This was done to facilitate a simpler model building and obtain a smaller RMSE. And, the other file had the artist’s name and their id.

Model Development, Validation and Selection: The file containing the user id, artist id and score was used to build the model in form of an RDD. That RDD was split into training, validation and testing sets of the ratio 6:2:2, with a fixed seed. For the validation and prediction, we created an RDD with only the user id and artist id. The model was built based on Alternating Least Squares (ALS) learning algorithm and the metric used to evaluate our model was RMSE. The training process involved varying the ranks and iterations (number of times ALS must run) and fixing a regularization parameter.

Model Prediction and Testing: The whole data was split in the ratio 70:30, 70% as training and 30% as testing data without scores. A model was trained, and this process took 634.796 seconds to train with rank 30 in 10 iterations and other parameters unchanged. Then prediction on test data which gave us an RMSE of 1.2134, that was comparable to validation and testing data set. A new user with user id as 0 was created with ratings for eight artists. The new user was then added to the original dataset. A new model was trained with the same parameters as before. Then the scores for each artist that our user 0 would give based on the eight artists he/she had rated before is predicted. Finally the predictions are sorted in descending order of predicted ratings and the top 5 artists’ in the list are recommended.
